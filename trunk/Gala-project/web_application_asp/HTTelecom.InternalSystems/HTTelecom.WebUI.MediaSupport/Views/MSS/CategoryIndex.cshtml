@{
    ViewBag.Action = "CategoryIndex";
    ViewBag.Controller = "MSS";
    Layout = "~/Views/Shared/_LayoutMain.cshtml";
}
<style>
    .tree {
        min-height: 20px;
        padding: 19px;
        margin-bottom: 20px;
        background-color: #fbfbfb;
        border: 1px solid #999;
        -webkit-border-radius: 4px;
        -moz-border-radius: 4px;
        border-radius: 4px;
        -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
        -moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
        box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
    }

        .tree li {
            list-style-type: none;
            margin: 0;
            padding: 10px 5px 0 5px;
            position: relative;
        }

            .tree li::before, .tree li::after {
                content: '';
                left: -20px;
                position: absolute;
                right: auto;
            }

            .tree li::before {
                border-left: 1px solid #999;
                bottom: 50px;
                height: 100%;
                top: 0;
                width: 1px;
            }

            .tree li::after {
                border-top: 1px solid #999;
                height: 20px;
                top: 25px;
                width: 25px;
            }

            .tree li span {
                -moz-border-radius: 5px;
                -webkit-border-radius: 5px;
                border: 1px solid #999;
                border-radius: 5px;
                display: inline-block;
                padding: 3px 8px;
                text-decoration: none;
            }

            .tree li.parent_li > span {
                cursor: pointer;
            }

        .tree > ul > li::before, .tree > ul > li::after {
            border: 0;
        }

        .tree li:last-child::before {
            height: 30px;
        }

        .tree li.parent_li > span:hover, .tree li.parent_li > span:hover + ul li span {
            background: #eee;
            border: 1px solid #94a0b4;
            color: #000;
        }
    </style>

@using PagedList;
@using PagedList.Mvc;
@using HTTelecom.Domain.Core.DataContext.mss

@model IList<Category>
<!-- Page Header -->
<div class="page-header page-header-block">
    <div class="page-header-section">
        <h4 class="title semibold">GALAGALA Media - Category</h4>
    </div>
    <div class="page-header-section">
        <!-- Toolbar -->
        <div class="toolbar">
            <ol class="breadcrumb breadcrumb-transparent nm">
                <li><i class="fa fa-home"></i>&nbsp;<a href="@Url.Action("Index","Home")">Home</a></li>
                <li class="active">Category</li>
            </ol>

        </div>
        <!--/ Toolbar -->
    </div>
</div>
@if (ViewBag.ResponseMessage != null)
{
    if (ViewBag.ResponseMessage == 1)
    {
        <div class="alert alert-success">
            <a href="#" class="close" data-dismiss="alert">&times;</a>
            <strong>Success!</strong> Your operation has been done successfully.
        </div>
    }
}

<!-- Page Header -->
<div class="row">
    <div class="col-md-12" style="margin-bottom: 15px;">
        <a href="@Url.Action("CategoryCreate", "MSS")" class="btn btn-info">Create New Category</a>
    </div>
</div>
<div class="row">  
    <div class="tree well">
        <div class="text-right"><input type="button" onclick="collapsesTree()" value="Expand All" /></div>
        @{
            List<Category_MultiLang> catelanguage = (List<Category_MultiLang>)ViewBag.LanguageCategoryName;
            List<Category_MultiLang> count_temp = new List<Category_MultiLang>();
            string categoryNameEn = "";
            string categoryNameVi = "";
            <ul>
                @foreach (var cate in Model.Where(x => x.CateLevel == 0).OrderBy(o => o.OrderNumber).ToList())
                {

                    count_temp = catelanguage.Where(c => c.CategoryId == cate.CategoryId & c.LanguageCode == "en").ToList();
                    categoryNameEn = count_temp.Count > 0 ? count_temp[0].CategoryName : "";
                    count_temp = catelanguage.Where(c => c.CategoryId == cate.CategoryId & c.LanguageCode == "vi").ToList();
                    categoryNameVi = count_temp.Count > 0 ? count_temp[0].CategoryName : "";
                    <li >

                        @if (Model.Where(x => x.ParentCateId == cate.CategoryId).ToList().Count > 0)
                        {
                            <span class="@(cate.IsDeleted == true ? "bg-danger" : "bg-info") ">
                                <i class="icon-folder-open"><b>@cate.OrderNumber</b></i>                               
                                @if (cate.IsActive == true)
                                {
                                    <a href="javascript:void(0);"><span class="label-success" style="color:white" data-toggle="tooltip" data-placement="top" data-original-title="Active">Active</span></a>
                                }
                                else
                                {
                                    <a href="javascript:void(0);"><span class="label-danger" style="color:white" data-toggle="tooltip" data-placement="top" data-original-title="Deactive">Deactive</span></a>
                                } 
                                [<b> @cate.CategoryId </b>]-[<b> @cate.CategoryName </b>]-[<b> @categoryNameEn </b>]-[<b> @categoryNameVi </b>]
                            </span>
                                <a class="btn-link" href="@Url.Action("CategoryEdit", "MSS" , new { id=cate.CategoryId, lang="zh" })" title="Edit with Taiwan Language"><strong><span>[Edit TW]</span></strong></a>
                                <a class="btn-link" href="@Url.Action("CategoryEdit/", "MSS", new { id = cate.CategoryId, lang = "en" })" title="Edit with English Language"><strong><span>[Edit EN]</span></strong></a>
                                <a class="btn-link" href="@Url.Action("CategoryEdit/", "MSS", new { id = cate.CategoryId, lang = "vi" })" title="Edit with VietNam Language"><strong><span>[Edit VI]</span></strong></a>
                            <span>+</span>                            
                            <ul>
                                @foreach (var cate2 in Model.Where(k => k.CateLevel == 1 & k.ParentCateId == cate.CategoryId).OrderBy(p => p.OrderNumber).ToList())
                                {
                                    count_temp = catelanguage.Where(c => c.CategoryId == cate2.CategoryId & c.LanguageCode == "en").ToList();
                                    categoryNameEn = count_temp.Count > 0 ? count_temp[0].CategoryName : "";
                                    count_temp = catelanguage.Where(c => c.CategoryId == cate2.CategoryId & c.LanguageCode == "vi").ToList();
                                    categoryNameVi = count_temp.Count > 0 ? count_temp[0].CategoryName : "";
                                    <li style="display: none;">

                                        @if (Model.Where(x => x.ParentCateId == cate2.CategoryId).ToList().Count > 0)
                                        {
                                            <span class="@(cate2.IsDeleted == true ? "bg-danger" : "bg-info") ">
                                                <i class="icon-minus-sign"><b>@cate2.OrderNumber</b></i>

                                                @if (cate2.IsActive == true)
                                                {
                                                    <a href="javascript:void(0);"><span class="label-success" style="color:white" data-toggle="tooltip" data-placement="top" data-original-title="Active">Active</span></a>
                                                }
                                                else
                                                {
                                                    <a href="javascript:void(0);"><span class="label-danger" style="color:white" data-toggle="tooltip" data-placement="top" data-original-title="Deactive">Deactive</span></a>
                                                }
                                                [<b> @cate2.CategoryId </b>]-[<b> @cate2.CategoryName </b>]-[<b> @categoryNameEn </b>]-[<b> @categoryNameVi </b>]
                                            </span>
                                            <a class="btn-link" href="@Url.Action("CategoryEdit", "MSS" , new { id=cate2.CategoryId, lang="zh" })" title="Edit with Taiwan Language"><strong><span>[Edit TW]</span></strong></a>
                                            <a class="btn-link" href="@Url.Action("CategoryEdit/", "MSS", new { id = cate2.CategoryId, lang = "en" })" title="Edit with English Language"><strong><span>[Edit EN]</span></strong></a>
                                            <a class="btn-link" href="@Url.Action("CategoryEdit/", "MSS", new { id = cate2.CategoryId, lang = "vi" })" title="Edit with VietNam Language"><strong><span>[Edit VI]</span></strong></a>

                                            <span>+</span>

                                            <ul>
                                                @foreach (var cate3 in Model.Where(y => y.CateLevel == 2 & y.ParentCateId == cate2.CategoryId).OrderBy(r => r.OrderNumber).ToList())
                                                {
                                                    count_temp = catelanguage.Where(c => c.CategoryId == cate3.CategoryId & c.LanguageCode == "en").ToList();
                                                    categoryNameEn = count_temp.Count > 0 ? count_temp[0].CategoryName : "";
                                                    count_temp = catelanguage.Where(c => c.CategoryId == cate3.CategoryId & c.LanguageCode == "vi").ToList();
                                                    categoryNameVi = count_temp.Count > 0 ? count_temp[0].CategoryName : "";
                                                    <li style="display: none;">
                                                        <span class="@(cate3.IsDeleted == true ? "bg-danger" : "bg-info") ">
                                                            <i class="icon-leaf"></i>

                                                            @if (cate3.IsActive == true)
                                                            {
                                                                <a href="javascript:void(0);"><span class="label-success" style="color:white" data-toggle="tooltip" data-placement="top" data-original-title="Active">Active</span></a>
                                                            }
                                                            else
                                                            {
                                                                <a href="javascript:void(0);"><span class="label-danger" style="color:white" data-toggle="tooltip" data-placement="top" data-original-title="Deactive">Deactive</span></a>
                                                            }
                                                            [<b> @cate3.CategoryId </b>]-[<b> @cate3.CategoryName </b>]-[<b> @categoryNameEn </b>]-[<b> @categoryNameVi </b>]
                                                        </span>
                                                        <a class="btn-link" href="@Url.Action("CategoryEdit", "MSS" , new { id = cate3.CategoryId, lang="zh" })" title="Edit with Taiwan Language"><strong><span>[Edit TW]</span></strong></a>
                                                        <a class="btn-link" href="@Url.Action("CategoryEdit/", "MSS", new { id = cate3.CategoryId, lang = "en" })" title="Edit with English Language"><strong><span>[Edit EN]</span></strong></a>
                                                        <a class="btn-link" href="@Url.Action("CategoryEdit/", "MSS", new { id = cate3.CategoryId, lang = "vi" })" title="Edit with VietNam Language"><strong><span>[Edit VI]</span></strong></a>

                                                    </li>
                                                }
                                            </ul>
                                        }
                                        else
                                        {
                                            <span class="@(cate2.IsDeleted == true ? "bg-danger" : "bg-info") ">
                                                <i class="icon-minus-sign"><b>@cate2.OrderNumber</b></i>
                                                @if (cate2.IsActive == true)
                                                {
                                                    <a href="javascript:void(0);"><span class="label-success" style="color:white" data-toggle="tooltip" data-placement="top" data-original-title="Active">Active</span></a>
                                                }
                                                else
                                                {
                                                    <a href="javascript:void(0);"><span class="label-danger" style="color:white" data-toggle="tooltip" data-placement="top" data-original-title="Deactive">Deactive</span></a>
                                                }
                                                [<b> @cate2.CategoryId </b>]-[<b> @cate2.CategoryName </b>]-[<b> @categoryNameEn </b>]-[<b> @categoryNameVi </b>]
                                            </span>
                                            <a class="btn-link" href="@Url.Action("CategoryEdit", "MSS" , new { id=cate2.CategoryId, lang="zh" })" title="Edit with Taiwan Language"><strong><span>[Edit TW]</span></strong></a>
                                            <a class="btn-link" href="@Url.Action("CategoryEdit/", "MSS", new { id = cate2.CategoryId, lang = "en" })" title="Edit with English Language"><strong><span>[Edit EN]</span></strong></a>
                                            <a class="btn-link" href="@Url.Action("CategoryEdit/", "MSS", new { id = cate2.CategoryId, lang = "vi" })" title="Edit with VietNam Language"><strong><span>[Edit VI]</span></strong></a>

                                        }
                                    </li>
                                }
                            </ul>
                        }
                        else
                        {
                            <span class="@(cate.IsDeleted == true ? "bg-danger" : "bg-info") ">
                                <i class="icon-folder-open"><b>@cate.OrderNumber</b></i>
                                @if (cate.IsActive == true)
                                {
                                    <a href="javascript:void(0);"><span class="label-success" style="color:white"  data-toggle="tooltip" data-placement="top" data-original-title="Active">Active</span></a>
                                }
                                else
                                {
                                    <a href="javascript:void(0);"><span class="label-danger" style="color:white" data-toggle="tooltip" data-placement="top" data-original-title="Deactive">Deactive</span></a>
                                }
                                [<b> @cate.CategoryId </b>]-[<b> @cate.CategoryName </b>]-[<b> @categoryNameEn </b>]-[<b> @categoryNameVi </b>]
                            </span>
                                <a class="btn-link" href="@Url.Action("CategoryEdit", "MSS" , new { id=cate.CategoryId, lang="zh" })" title="Edit with Taiwan Language"><strong><span>[Edit TW]</span></strong></a>
                                <a class="btn-link" href="@Url.Action("CategoryEdit/", "MSS", new { id = cate.CategoryId, lang = "en" })" title="Edit with English Language"><strong><span>[Edit EN]</span></strong></a>
                                <a class="btn-link" href="@Url.Action("CategoryEdit/", "MSS", new { id = cate.CategoryId, lang = "vi" })" title="Edit with VietNam Language"><strong><span>[Edit VI]</span></strong></a>
                           
                        }
                    </li>
                }
            </ul>
        }      
    </div>
</div>



<!--/ END row -->
<script language="javascript" type="text/javascript">

    function collapsesTree()
    {
        $('li').each(function (i) {
            $(this).attr('style', 'display: list-item');
        });
    }
    $(function () {
        $('.tree li:has(ul)').addClass('parent_li').find(' > span').attr('title', 'Collapse this branch');
        $('.tree li.parent_li > span').on('click', function (e) {
            var children = $(this).parent('li.parent_li').find(' > ul > li');
            if (children.is(":visible")) {
                children.hide('fast');
                $(this).attr('title', 'Expand this branch').find(' > i').addClass('icon-plus-sign').removeClass('icon-minus-sign');
            } else {
                children.show('fast');
                $(this).attr('title', 'Collapse this branch').find(' > i').addClass('icon-minus-sign').removeClass('icon-plus-sign');
            }
            e.stopPropagation();
        });
    });
</script>
